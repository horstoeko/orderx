<?php

use horstoeko\orderx\OrderDocumentBuilder;
use horstoeko\orderx\OrderProfiles;

require getcwd() . "/../vendor/autoload.php";

$document = OrderDocumentBuilder::CreateNew(OrderProfiles::PROFILE_EXTENDED);
$document
    ->setIsDocumentCopy(false)
    ->setIsTestDocument()
    ->setDocumentBusinessProcessSpecifiedDocumentContextParameter("A1")
    ->addDocumentNote("Content of Note", "AAI", "AAI")
    ->setDocumentInformation("PO123456789", "220", new \DateTime(), "EUR", "Doc Name", "de", new \DateTime(), "9", "AC")
    ->setDocumentSummation(119, 119, 100, 0, 0, 100, 19, 0, 0)
    ->setDocumentBuyerReference("NaNananaa")
    ->setDocumentSeller("Lieferant Name", "0815", "Lieferant")
    ->addDocumentSellerGlobalId("827397213", "0088")
    ->addDocumentSellerTaxRegistration("VA", "FR 32 123 456 789")
    ->addDocumentSellerTaxRegistration("FC", "SELLER_TAX_ID")
    ->setDocumentSellerAddress("Line 1", "Line 2", "Line 3", "06110", "Musterstadt", "DE", "Saxony")
    ->setDocumentSellerLegalOrganisation("0002", "123456789", "Lieferant AG")
    ->setDocumentSellerContact("PersonName", "PersonDepartment", "+49-111-12345678", "+49-111-2222222", "info@lieferant.ag", "SR")
    ->setDocumentBuyer("Kunde", "0815", "Ein Kunde")
    ->addDocumentBuyerGlobalId("12345", "9999")
    ->addDocumentBuyerTaxRegistration("VA", "3483747 490893 9384")
    ->setDocumentBuyerAddress("Address 1", "Address 2", "Address 3", "11111", "Musterhausen", "DE", "Mallorca")
    ->setDocumentBuyerLegalOrganisation("111", "222", "Kunde")
    ->setDocumentBuyerContact("Contact 1", "At home", "+49-111-222222", "+49-111-333333", "info@kunde.de")
    ->addDocumentBuyerContact("Contact 2", "Also at home", "+49-111-444444", "+49-111-7777777", "info2@kunde.de")
    ->setDocumentBuyerRequisitioner("Kunde_Reg", "0816", "Ein Requisitioner")
    ->addDocumentBuyerRequisitionerGlobalId("98876", "192835")
    ->setDocumentBuyerRequisitionerAddress("l1", "l2", "l3", "00000", "City", "DE", 'Mallorca')
    ->setDocumentBuyerRequisitionerLegalOrganisation("legalordid", "legalorgtype", "legalorgname")
    ->setDocumentBuyerRequisitionerContact("contname", "contdep", "+49-777-0000000", "+49-777-9999999", "info@requisitioner.com")
    ->addDocumentBuyerRequisitionerContact("contname2", "contdep2", "+49-777-0000000-2", "+49-777-9999999-2", "info2@requisitioner.com")
    ->setDocumentDeliveryTerms("dc", "dcdesc", "fc", "tlid", "tlname")
    ->setDocumentSellerOrderReferencedDocument("sellerorderid", new \DateTime())
    ->setDocumentBuyerOrderReferencedDocument("buyerorderid", new \DateTime())
    ->setDocumentQuotationReferencedDocument("quoteid", new \DateTime())
    ->setDocumentContractReferencedDocument("contractid", new \DateTime())
    ->setDocumentRequisitionReferencedDocument("reqid", new \DateTime())
    ->addDocumentAdditionalReferencedDocument("ADD_REF_DOC_ID", "916", "ADD_REF_DOC_URIID", "ADD_REF_DOC_Desc")
    ->addDocumentAdditionalReferencedDocument("TENDER_ID", "50")
    ->addDocumentAdditionalReferencedDocument("OBJECT_ID", "130", null, null, "AWV")
    ->setDocumentBlanketOrderReferencedDocument("BLANKET_ORDER_OD", new \DateTime())
    ->setDocumentPreviousOrderChangeReferencedDocument("PREV_ORDER_C_ID", new \DateTime())
    ->setDocumentPreviousOrderResponseReferencedDocument("PREV_ORDER_R_ID", new \DateTime())
    ->setDocumentProcuringProject("PROJECT_ID", "Project Reference")
    ->setDocumentShipTo("SHIP_TO_NAME", "SHIP_TO_ID", "Ship-to Name")
    ->addDocumentShipToGlobalId("SHIP_TO_GLOBALID_1", "0088")
    ->addDocumentShipToGlobalId("SHIP_TO_GLOBALID_2", "0099")
    ->addDocumentShipToTaxRegistration("VA", "12345")
    ->addDocumentShipToTaxRegistration("FC", "67890")
    ->setDocumentShipToAddress("line1", "line2", "line3", "00000", "City", "DE", "Mallorca")
    ->setDocumentShipToLegalOrganisation("SHIP_TO_LEGALORGID", "SHIP_TO_LEGALORGTYPE", "SHIP_TO_LEGALORGNAME")
    ->setDocumentShipToContact("Personname", "department", "+49-000-9999999", "+49-111-8888888", "info@nowhere.all")
    ->addDocumentShipToContact("Personname 2", "department 2", "+49-000-9999999-2", "+49-111-8888888-2", "info2@nowhere.all")
    ->setDocumentShipFrom("SHIP_FROM_NAME", "SHIP_FROM_ID", "Ship-to Name")
    ->addDocumentShipFromGlobalId("SHIP_FROM_GLOBALID_1", "0088")
    ->addDocumentShipFromGlobalId("SHIP_FROM_GLOBALID_2", "0099")
    ->addDocumentShipFromTaxRegistration("VA", "12345")
    ->addDocumentShipFromTaxRegistration("FC", "67890")
    ->setDocumentShipFromAddress("line1", "line2", "line3", "00000", "City", "DE", "Mallorca")
    ->setDocumentShipFromLegalOrganisation("SHIP_TO_LEGALORGID", "SHIP_TO_LEGALORGTYPE", "SHIP_TO_LEGALORGNAME")
    ->setDocumentShipFromContact("Personname", "department", "+49-000-9999999", "+49-111-8888888", "info@nowhere.all")
    ->addDocumentShipFromContact("Personname 2", "department 2", "+49-000-9999999-2", "+49-111-8888888-2", "info2@nowhere.all")
    ->setDocumentRequestedDeliverySupplyChainEvent(new \DateTime(), new \DateTime(), new \DateTime())
    ->setDocumentInvoicee("INVOICEE_NAME", "INVOICEE_ID", "Invoicee")
    ->addDocumentInvoiceeGlobalId("INVOICE_GLOBAL_ID_1", "INVOICE_GLOBAL_ID_TYPE_1")
    ->addDocumentInvoiceeGlobalId("INVOICE_GLOBAL_ID_2", "INVOICE_GLOBAL_ID_TYPE_2")
    ->addDocumentInvoiceeTaxRegistration("FC", "INVOICEE_1")
    ->addDocumentInvoiceeTaxRegistration("VA", "INVOICEE_2")
    ->setDocumentInvoiceeAddress("Line 1", "LIne 2", "Line 3", "00000", "City", "Mallorca")
    ->setDocumentInvoiceeLegalOrganisation("INVOICEE_LEGALORG_ID", "INVOICEE_LEGALORG_TYPE", "Organization")
    ->setDocumentInvoiceeContact("Personname", "department", "+49-000-9999999", "+49-111-8888888", "info@nowhere.all")
    ->addDocumentInvoiceeContact("Personname 2", "department 2", "+49-000-9999999-2", "+49-111-8888888-2", "info2@nowhere.all")
    ->setDocumentPaymentMean("30", "PaymentMean")
    ->addDocumentPaymentTerm("PAYMENT_TERMS_DESC")
    ->addDocumentAllowanceCharge(31.00, false, "S", "VAT", 20, 0, 10.00, 310.00, null, null, "64", "SPECIAL AGREEMENT")
    ->setDocumentSummation(360, 310, 21, 31, 300, 60)
    ->setDocumentReceivableSpecifiedTradeAccountingAccount("ACC1", null)

    ->addNewPosition("1")
    ->setDocumentPositionNote("WEEE Tax of 0,50 euros per item included", null, "TXD")
    ->setDocumentPositionProductDetails("Product Name", "Product Description", "987654321", "654987321", "0160", "1234567890123", "Product Batch ID (lot ID)", "Product Brand Name")
    ->addDocumentPositionProductCharacteristic("Characteristic Description", "5 meters", "Characteristic_Code")
    ->addDocumentPositionProductClassification("Class_code", "Name Class Codification", "TST")
    ->setDocumentPositionProductInstance("Product Instances Batch ID", "Product Instances Supplier Serial ID")
    ->setDocumentPositionApplicableSupplyChainPackaging("7B", 5, "MTR", 3, "MTR", 1, "MTR")
    ->setDocumentPositionProductOriginTradeCountry("FR")
    ->setDocumentPositionProductReferencedDocument("ADD_REF_PROD_ID", "6", "ADD_REF_PROD_URIID", null, "ADD_REF_PROD_Desc")
    ->setDocumentPositionBuyerOrderReferencedDocument("3")
    ->setDocumentPositionQuotationReferencedDocument("QUOT_125487", "2")
    ->addDocumentPositionAdditionalReferencedDocument("ADD_REF_DOC_ID", "916", "ADD_REF_DOC_URIID", 5, "ADD_REF_DOC_Desc")
    ->addDocumentPositionAdditionalReferencedDocument("OBJECT_125487", "130", null, null, null, "AWV")
    ->setDocumentPositionGrossPrice(10.50, 1, "C62")
    ->addDocumentPositionGrossPriceAllowanceCharge(1.00, false, null, null, "DISCOUNT", null, null, null, null, "95")
    ->addDocumentPositionGrossPriceAllowanceCharge(0.50, true, null, null, "WEEE", null, null, null, null, "AEW")
    ->setDocumentPositionNetPrice(10, 1, "C62")
    ->setDocumentPositionCatalogueReferencedDocument("CATALOG_REF_ID", 2)
    ->setDocumentPositionBlanketOrderReferencedDocument(2)
    ->writeFile(getcwd() . "/order-x.xml");
